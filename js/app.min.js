var App={Model:{},Controller:{},Router:{},Util:{}};App.Util.getJSON=function(a,b,c){"use strict";var d=new XMLHttpRequest;d.overrideMimeType("application/json"),d.open("GET",a,!0),d.onreadystatechange=function(){var a,e;if(4===d.readyState){if(e=d.responseText,200!==d.status)return void b({name:"Error",message:e});a=JSON.parse(e),c(a)}},d.send(null)},App.Router=function(){"use strict";function a(){this.routes={"":"Top","#top":"Top"}}return a.prototype.Launch=function(){try{var a=window.location.hash,b=this.routes[a];this[b]()}catch(c){this.Error(c)}},a.prototype.Top=function(){App.Controller.Repositories},a.prototype.Error=function(a){throw new Error(a)},new a}(),App.Model.Repositories=function(){"use strict";function a(){return this.page=1,this.previousPages=[],this.collection=[],this.per_page=100,this.uri="https://api.github.com/orgs/gree/repos",this}return a.prototype.add=function(a){this.collection.push(a)},a.prototype.get=function(a){a=a||"";var b=this.collection,c=-1!==a.indexOf("at");return null!==a&&(b=b.sort(function(b,d){return b=b[a],d=d[a],c&&(b=new Date(b),d=new Date(d)),d>b?1:-1})),b},a.prototype.fetch=function(){var a=this,b=this.uri;return b+="?per_page="+this.per_page,b+="&page="+this.page,new Promise(function(c,d){try{-1!==a.previousPages.indexOf(a.page)&&c(a.collection),a.previousPages.push(a.page),App.Util.getJSON(b,d,function(b){b.forEach(function(a){var b=a.language||"";b=b.replace(/\#/g,"sharp"),b=b.replace(/\+/g,"plus"),App.Model.Repositories.add({name:a.name,description:a.description,homepage:a.homepage,html_url:a.html_url,language:a.language,pushed_at:a.pushed_at,code:b})}),c(a.collection)})}catch(e){d(e)}})},new a}(),App.Router.Launch(),App.Controller.Repositories=function(){"use strict";function a(){d(e)}function b(){var a=JST.repositories,b=App.Model.Repositories.get("pushed_at"),c=a({repositories:b}),d=document.getElementById("js__repositories");d.innerHTML=c}function c(a,b){var c=JST.error,d=c({name:a,message:b}),e=document.getElementById("js__repositories");e.innerHTML=d}function d(a){App.Model.Repositories.fetch(a).then(function(){b()},function(a){c(a.name,a.message)})}var e=1;a()}();